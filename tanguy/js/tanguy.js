var TANGUY={synth:new AudioContext,octave_shift:0,osc1_master_pitch:440,osc2_master_pitch:444.18,key_down:!1,program:{name:"INITIALIZE",osc1:{kbd:!0,coarse:1,saw_amt:1,sqr_amt:0,tri_amt:0,sin_amt:0,fm_amt:0},osc2:{kbd:!0,coarse:1,waveform:"sawtooth",detune:0,fine:0,shape_amt:0,fm_amt:0},noise:{color:"white"},lfo:{shape:"sine",rate:.1,pitch_amt:0,filter_amt:0,amp_amt:0},mixer:{osc1:1,osc2:1,noise:0},filter:{mode:"lp",frequency:22050,resonance:1e-4,env_amt:0,kbd:0,attack:8e-4,decay:8e-4,sustain:0,release:8e-4},vca:{gain:0,attack:1e-4,decay:1e-4,sustain:1,release:1e-4},portamento:{mode:"off",amt:.01},mod:{amt:0,direction:1},delay:{rate:0,amt:0}}};TANGUY.save_program=function(){"use strict";var e=prompt("PATCH NAME");TANGUY.program.name=e,console.log("SAVE PROGRAM: "+JSON.stringify(TANGUY.program))},TANGUY.load_program=function(e){"use strict";var t,r=encodeURI("programs/")+e+".json",a=[TANGUY.osc1_saw,TANGUY.osc1_sqr,TANGUY.osc1_tri,TANGUY.osc1_sin],s=[TANGUY.delay1,TANGUY.delay2,TANGUY.delay3,TANGUY.delay4],n=[TANGUY.delay1_vca,TANGUY.delay2_vca,TANGUY.delay3_vca,TANGUY.delay4_vca];$.getJSON(decodeURI(r),function(e){var r,i=$("#osc1-kbd"),c=$("#osc2-kbd");switch(TANGUY.program=e,TANGUY.program.osc1.kbd===!0?i.prop("checked",!0):i.prop("checked",!1),TANGUY.program.osc1.coarse){case.5:$("#osc1-32").parent().addClass("selected").siblings().removeClass("selected");break;case 1:$("#osc1-16").parent().addClass("selected").siblings().removeClass("selected");break;case 2:$("#osc1-8").parent().addClass("selected").siblings().removeClass("selected");break;case 4:$("#osc1-4").parent().addClass("selected").siblings().removeClass("selected")}for(t=0;4>t;t+=1)a[t].frequency.setValueAtTime(TANGUY.osc1_master_pitch*TANGUY.program.osc1.coarse,TANGUY.synth.currentTime);switch($("#osc1-saw").val(TANGUY.program.osc1.saw_amt),$("#osc1-sqr").val(TANGUY.program.osc1.sqr_amt),$("#osc1-tri").val(TANGUY.program.osc1.tri_amt),$("#osc1-sin").val(TANGUY.program.osc1.sin_amt),$("#osc1-fm").val(TANGUY.program.osc1.fm_amt),TANGUY.osc1_saw_vca.gain.setValueAtTime(TANGUY.program.osc1.saw_amt,TANGUY.synth.currentTime),TANGUY.osc1_sqr_vca.gain.setValueAtTime(TANGUY.program.osc1.sqr_amt,TANGUY.synth.currentTime),TANGUY.osc1_tri_vca.gain.setValueAtTime(TANGUY.program.osc1.tri_amt,TANGUY.synth.currentTime),TANGUY.osc1_sin_vca.gain.setValueAtTime(TANGUY.program.osc1.sin_amt,TANGUY.synth.currentTime),TANGUY.osc1_fm_vca.gain.setValueAtTime(TANGUY.program.osc1.fm_amt*TANGUY.program.osc1.fm_amt*24e3,TANGUY.synth.currentTime),TANGUY.program.osc2.kbd===!0?c.prop("checked",!0):c.prop("checked",!1),TANGUY.program.osc2.coarse){case.5:$("#osc2-32").parent().addClass("selected").siblings().removeClass("selected");break;case 1:$("#osc2-16").parent().addClass("selected").siblings().removeClass("selected");break;case 2:$("#osc2-8").parent().addClass("selected").siblings().removeClass("selected");break;case 4:$("#osc2-4").parent().addClass("selected").siblings().removeClass("selected")}switch(TANGUY.osc2.frequency.setValueAtTime(TANGUY.osc2_master_pitch*TANGUY.program.osc2.coarse+TANGUY.program.osc2.fine,TANGUY.synth.currentTime),TANGUY.program.osc2.waveform){case"sawtooth":$("#osc2-saw").parent().addClass("selected").siblings().removeClass("selected");break;case"square":$("#osc2-sqr").parent().addClass("selected").siblings().removeClass("selected");break;case"triangle":$("#osc2-tri").parent().addClass("selected").siblings().removeClass("selected");break;case"sine":$("#osc2-sin").parent().addClass("selected").siblings().removeClass("selected")}switch(TANGUY.osc2.type=TANGUY.program.osc2.waveform,$("#osc2-detune").val(TANGUY.program.osc2.detune),$("#osc2-fine").val(TANGUY.program.osc2.fine),$("#osc2-waveshape").val(TANGUY.program.osc2.shape_amt),$("#osc2-fm").val(TANGUY.program.osc2.fm_amt),TANGUY.osc2.detune.setValueAtTime(TANGUY.osc2_master_pitch+TANGUY.program.osc2.detune,TANGUY.synth.currentTime),TANGUY.osc2.frequency.setValueAtTime(TANGUY.osc2_master_pitch*TANGUY.program.osc2.coarse+TANGUY.program.osc2.fine,TANGUY.synth.currentTime),TANGUY.osc2.shape_amt>0?(r=this.value,TANGUY.waveshaper.curve=new Float32Array([1.6*r,-2.5*r,-1.2*r,-2.4*r,-1.6*r,-3.2*r,6.4*r,-3.2*r])):TANGUY.waveshaper.curve=null,TANGUY.osc2_fm_vca.gain.setValueAtTime(TANGUY.program.osc2.fm_amt*TANGUY.program.osc2.fm_amt*24e3,TANGUY.synth.currentTime),TANGUY.program.noise.color){case"white":$("#white-noise").parent().addClass("selected").siblings().removeClass("selected"),TANGUY.white_noise.buffer=TANGUY.white_noise_buffer,TANGUY.pink_noise.buffer=TANGUY.empty_pink_noise_buffer,TANGUY.red_noise.buffer=TANGUY.empty_red_noise_buffer,TANGUY.blue_noise.buffer=TANGUY.empty_blue_noise_buffer,TANGUY.purple_noise.buffer=TANGUY.empty_purple_noise_buffer;break;case"pink":$("#pink-noise").parent().addClass("selected").siblings().removeClass("selected"),TANGUY.pink_noise.buffer=TANGUY.pink_noise_buffer,TANGUY.white_noise.buffer=TANGUY.empty_white_noise_buffer,TANGUY.red_noise.buffer=TANGUY.empty_red_noise_buffer,TANGUY.blue_noise.buffer=TANGUY.empty_blue_noise_buffer,TANGUY.purple_noise.buffer=TANGUY.empty_purple_noise_buffer;break;case"red":$("#red-noise").parent().addClass("selected").siblings().removeClass("selected"),TANGUY.red_noise.buffer=TANGUY.red_noise_buffer,TANGUY.white_noise.buffer=TANGUY.empty_white_noise_buffer,TANGUY.pink_noise.buffer=TANGUY.empty_pink_noise_buffer,TANGUY.blue_noise.buffer=TANGUY.empty_blue_noise_buffer,TANGUY.purple_noise.buffer=TANGUY.empty_purple_noise_buffer;break;case"blue":$("#blue-noise").parent().addClass("selected").siblings().removeClass("selected"),TANGUY.blue_noise.buffer=TANGUY.blue_noise_buffer,TANGUY.white_noise.buffer=TANGUY.empty_white_noise_buffer,TANGUY.pink_noise.buffer=TANGUY.empty_pink_noise_buffer,TANGUY.red_noise.buffer=TANGUY.empty_red_noise_buffer,TANGUY.purple_noise.buffer=TANGUY.empty_purple_noise_buffer;break;case"purple":$("#purple-noise").parent().addClass("selected").siblings().removeClass("selected"),TANGUY.purple_noise.buffer=TANGUY.purple_noise_buffer,TANGUY.white_noise.buffer=TANGUY.empty_white_noise_buffer,TANGUY.pink_noise.buffer=TANGUY.empty_pink_noise_buffer,TANGUY.red_noise.buffer=TANGUY.empty_red_noise_buffer,TANGUY.blue_noise.buffer=TANGUY.empty_blue_noise_buffer}switch($("#osc1-mix").val(TANGUY.program.mixer.osc1),$("#osc2-mix").val(TANGUY.program.mixer.osc2),$("#noise-mix").val(TANGUY.program.mixer.noise),TANGUY.osc1_vca.gain.value=TANGUY.program.mixer.osc1,TANGUY.osc2_vca.gain.value=TANGUY.program.mixer.osc2,TANGUY.noise_vca.gain.value=TANGUY.program.mixer.noise,$("#cutoff").val(Math.sqrt((TANGUY.program.filter.frequency-20)/22030)),$("#resonance").val(Math.sqrt(TANGUY.program.filter.resonance/1e3)),TANGUY.program.filter.mode){case"lp":$("#filter-lp").parent().addClass("selected").siblings().removeClass("selected"),TANGUY.mixer.disconnect(),TANGUY.mixer.connect(TANGUY.lp_filter1),TANGUY.lp_filter1.frequency.setValueAtTime(TANGUY.program.filter.frequency,TANGUY.synth.currentTime),TANGUY.lp_filter2.frequency.setValueAtTime(TANGUY.program.filter.frequency/2,TANGUY.synth.currentTime),TANGUY.lp_filter1.Q.setValueAtTime(TANGUY.program.filter.resonance/82,TANGUY.synth.currentTime),TANGUY.lp_filter2.Q.setValueAtTime(TANGUY.program.filter.resonance/123,TANGUY.synth.currentTime),TANGUY.lfo_filter_vca.disconnect(),TANGUY.lfo_filter_vca.connect(TANGUY.lp_filter1.frequency),TANGUY.lfo_filter_vca.connect(TANGUY.lp_filter2.frequency);break;case"bp":$("#filter-bp").parent().addClass("selected").siblings().removeClass("selected"),TANGUY.mixer.disconnect(),TANGUY.mixer.connect(TANGUY.bp_filter1),TANGUY.bp_filter1.frequency.setValueAtTime(TANGUY.program.filter.frequency,TANGUY.synth.currentTime),TANGUY.bp_filter2.frequency.setValueAtTime(.9*TANGUY.program.filter.frequency,TANGUY.synth.currentTime),TANGUY.bp_filter3.frequency.setValueAtTime(1.1*TANGUY.program.filter.frequency,TANGUY.synth.currentTime),TANGUY.bp_filter2.gain.setValueAtTime(TANGUY.program.filter.resonance/82,TANGUY.synth.currentTime),TANGUY.bp_filter3.gain.setValueAtTime(TANGUY.program.filter.resonance/82,TANGUY.synth.currentTime),TANGUY.lfo_filter_vca.disconnect(),TANGUY.lfo_filter_vca.connect(TANGUY.bp_filter1.frequency),TANGUY.lfo_filter_vca.connect(TANGUY.bp_filter2.frequency),TANGUY.lfo_filter_vca.connect(TANGUY.bp_filter3.frequency);break;case"hp":$("#filter-hp").parent().addClass("selected").siblings().removeClass("selected"),TANGUY.mixer.disconnect(),TANGUY.mixer.connect(TANGUY.hp_filter1),TANGUY.hp_filter1.frequency.setValueAtTime(TANGUY.program.filter.frequency,TANGUY.synth.currentTime),TANGUY.hp_filter2.frequency.setValueAtTime(TANGUY.program.filter.frequency,TANGUY.synth.currentTime),TANGUY.hp_filter1.Q.setValueAtTime(TANGUY.program.filter.resonance/82,TANGUY.synth.currentTime),TANGUY.hp_filter2.Q.setValueAtTime(TANGUY.program.filter.resonance/123,TANGUY.synth.currentTime),TANGUY.lfo_filter_vca.disconnect(),TANGUY.lfo_filter_vca.connect(TANGUY.hp_filter1.frequency),TANGUY.lfo_filter_vca.connect(TANGUY.hp_filter2.frequency);break;case"notch":$("#filter-notch").parent().addClass("selected").siblings().removeClass("selected"),TANGUY.mixer.disconnect(),TANGUY.mixer.connect(TANGUY.notch1),TANGUY.notch1.frequency.setValueAtTime(TANGUY.program.filter.frequency,TANGUY.synth.currentTime),TANGUY.notch2.frequency.setValueAtTime(.9*TANGUY.program.filter.frequency,TANGUY.synth.currentTime),TANGUY.notch3.frequency.setValueAtTime(1.1*TANGUY.program.filter.frequency,TANGUY.synth.currentTime),TANGUY.notch2.gain.setValueAtTime(TANGUY.program.filter.resonance/-21,TANGUY.synth.currentTime,.01),TANGUY.notch3.gain.setValueAtTime(TANGUY.program.filter.resonance/-21,TANGUY.synth.currentTime,.01),TANGUY.lfo_filter_vca.disconnect(),TANGUY.lfo_filter_vca.connect(TANGUY.notch1.frequency),TANGUY.lfo_filter_vca.connect(TANGUY.notch2.frequency),TANGUY.lfo_filter_vca.connect(TANGUY.notch3.frequency);break;case"off":$("#filter-off").parent().addClass("selected").siblings().removeClass("selected"),TANGUY.mixer.disconnect(),TANGUY.mixer.connect(TANGUY.vca),TANGUY.lfo_filter_vca.disconnect()}switch($("#filter-envelope-amount").val(TANGUY.program.filter.env_amt),$("#filter-keyboard-tracking").val(TANGUY.program.filter.kbd),$("#filter-attack").val(TANGUY.program.filter.attack),$("#filter-decay").val(TANGUY.program.filter.decay),$("#filter-sustain").val(TANGUY.program.filter.sustain),$("#filter-release").val(TANGUY.program.filter.release),$("#vca-attack").val(TANGUY.program.vca.attack),$("#vca-decay").val(TANGUY.program.vca.decay),$("#vca-sustain").val(TANGUY.program.vca.sustain),$("#vca-release").val(TANGUY.program.vca.release),$("#vca-gain").val(Math.sqrt(TANGUY.program.vca.gain)),TANGUY.vca.gain.setValueAtTime(TANGUY.program.vca.gain,TANGUY.synth.currentTime),TANGUY.program.lfo.shape){case"sine":$("#lfo-sin").parent().addClass("selected").siblings().removeClass("selected"),TANGUY.program.mod.direction=1,TANGUY.lfo.type="sine";break;case"triangle":$("#lfo-tri").parent().addClass("selected").siblings().removeClass("selected"),TANGUY.program.mod.direction=1,TANGUY.lfo.type="triangle";break;case"ramp":$("#lfo-rmp").parent().addClass("selected").siblings().removeClass("selected"),TANGUY.program.mod.direction=1,TANGUY.lfo.type="sawtooth",TANGUY.calculate_lfo();break;case"sawtooth":$("#lfo-saw").parent().addClass("selected").siblings().removeClass("selected"),TANGUY.program.mod.direction=-1,TANGUY.lfo.type="sawtooth",TANGUY.calculate_lfo();break;case"square":$("#lfo-sqr").parent().addClass("selected").siblings().removeClass("selected"),TANGUY.program.mod.direction=1,TANGUY.lfo.type="square"}for($("#delay-rate").val(TANGUY.program.delay.rate),$("#delay-amount").val(TANGUY.program.delay.amt),t=0;4>t;t+=1)s[t].delayTime.value=TANGUY.program.delay.rate;for(t=0;4>t;t+=1)n[t].gain.value=TANGUY.program.delay.amt;switch($("#mod-amount").val(TANGUY.program.mod.amt),TANGUY.calculate_lfo(),$("#lfo-rate").val(Math.sqrt(TANGUY.program.lfo.rate/100)),TANGUY.lfo.frequency.value=TANGUY.program.lfo.rate,$("#lfo-pitch").val(TANGUY.program.lfo.pitch_amt),$("#lfo-filter").val(TANGUY.program.lfo.filter_amt),$("#lfo-amp").val(TANGUY.program.lfo.amp_amt),TANGUY.calculate_lfo(),$("#portamento-amount").val(TANGUY.program.portamento.amt),TANGUY.program.portamento.mode){case"off":$("#portamento-off").parent().addClass("selected").siblings().removeClass("selected");break;case"linear":$("#portamento-linear").parent().addClass("selected").siblings().removeClass("selected");break;case"exponential":$("#portamento-exponential").parent().addClass("selected").siblings().removeClass("selected")}})},$("#program-selector").change(function(){"use strict";TANGUY.load_program(this.value),$(this).blur()}),TANGUY.shift_octave=function(e){"use strict";var t=[$("#octave-minus-2"),$("#octave-minus-1"),$("#octave-plus-0"),$("#octave-plus-1"),$("#octave-plus-2")];e>0&&TANGUY.octave_shift<2?(TANGUY.octave_shift+=1,t[TANGUY.octave_shift+2].addClass("lit"),t[TANGUY.octave_shift+1].removeClass("lit")):0>e&&TANGUY.octave_shift>-2&&(TANGUY.octave_shift-=1,t[TANGUY.octave_shift+2].addClass("lit"),t[TANGUY.octave_shift+3].removeClass("lit"))},$("#octave-shift").on("click","button",function(){"use strict";return TANGUY.shift_octave(this.getAttribute("data-octave-shift"))}),TANGUY.multi_switch=function(e){"use strict";$(e.currentTarget).parent().addClass("selected").siblings().removeClass("selected")},$("#osc1-coarse, #osc2-coarse, #portamento-mode, #osc2-waveform, #noise-color, #filter-mode, #lfo-shape").on("click","input",$(this),TANGUY.multi_switch),TANGUY.stop_tweaking=function(){"use strict";return $(this).unbind("mousemove")},TANGUY.calculate_lfo=function(){"use strict";var e;for(e=0;e<arguments.length;e+=1)"pitch"===arguments[e]&&(TANGUY.lfo_pitch_vca.gain.value=TANGUY.program.lfo.pitch_amt*TANGUY.program.mod.amt*TANGUY.program.mod.direction),"filter"===arguments[e]&&(TANGUY.lfo_filter_vca.gain.value=TANGUY.program.lfo.filter_amt*TANGUY.program.mod.amt*TANGUY.program.mod.direction),"amp"===arguments[e]&&(TANGUY.lfo_amp_vca.gain.value=TANGUY.program.lfo.amp_amt*TANGUY.program.mod.amt*TANGUY.program.mod.direction);0===arguments.length&&TANGUY.calculate_lfo("pitch","filter","amp")},TANGUY.calculate_pitch=function(e,t){"use strict";var r,a=1200*(TANGUY.octave_shift+e)+t,s=1200*(TANGUY.octave_shift+e)+(t+TANGUY.program.osc2.detune),n=(4800-a)*TANGUY.program.filter.kbd,i=[TANGUY.osc1_saw,TANGUY.osc1_sqr,TANGUY.osc1_tri,TANGUY.osc1_sin],c=function(){if(TANGUY.program.osc1.kbd===!0)for(r=0;4>r;r+=1)i[r].detune.setValueAtTime(a,TANGUY.synth.currentTime);TANGUY.program.osc2.kbd===!0&&TANGUY.osc2.detune.setValueAtTime(s,TANGUY.synth.currentTime)},o=function(){if(TANGUY.program.osc1.kbd===!0)for(r=0;4>r;r+=1)i[r].detune.linearRampToValueAtTime(a,TANGUY.synth.currentTime+parseFloat(TANGUY.program.portamento.amt));TANGUY.program.osc2.kbd===!0&&TANGUY.osc2.detune.linearRampToValueAtTime(s,TANGUY.synth.currentTime+parseFloat(TANGUY.program.portamento.amt))},T=function(){if(TANGUY.program.osc1.kbd===!0)for(r=0;4>r;r+=1)i[r].detune.setTargetAtTime(a,TANGUY.synth.currentTime,TANGUY.program.portamento.amt/5);TANGUY.program.osc2.kbd===!0&&TANGUY.osc2.detune.setTargetAtTime(s,TANGUY.synth.currentTime,TANGUY.program.portamento.amt/5)};switch(TANGUY.osc1_pitch=a,TANGUY.osc2_pitch=s,TANGUY.program.portamento.mode){case"off":c();break;case"linear":o();break;case"exponential":T()}switch(TANGUY.program.filter.mode){case"lp":TANGUY.lp_filter1.detune.setValueAtTime(n,TANGUY.synth.currentTime),TANGUY.lp_filter2.detune.setValueAtTime(n/2,TANGUY.synth.currentTime);break;case"bp":TANGUY.bp_filter1.detune.setValueAtTime(n,TANGUY.synth.currentTime),TANGUY.bp_filter2.detune.setValueAtTime(n,TANGUY.synth.currentTime),TANGUY.bp_filter3.detune.setValueAtTime(n,TANGUY.synth.currentTime);break;case"hp":TANGUY.hp_filter1.detune.setValueAtTime(n,TANGUY.synth.currentTime),TANGUY.hp_filter2.detune.setValueAtTime(n,TANGUY.synth.currentTime);break;case"notch":TANGUY.notch1.detune.setValueAtTime(n,TANGUY.synth.currentTime),TANGUY.notch2.detune.setValueAtTime(n,TANGUY.synth.currentTime),TANGUY.notch3.detune.setValueAtTime(n,TANGUY.synth.currentTime);break;case"off":}},TANGUY.gate_on=function(){"use strict";var e=TANGUY.program.filter.env_amt+TANGUY.program.filter.frequency,t=TANGUY.synth.currentTime+TANGUY.program.filter.attack,r=TANGUY.synth.currentTime+TANGUY.program.vca.attack;switch(TANGUY.program.filter.mode){case"lp":TANGUY.lp_filter1.frequency.setValueAtTime(TANGUY.program.filter.frequency,TANGUY.synth.currentTime),TANGUY.lp_filter2.frequency.setValueAtTime(TANGUY.program.filter.frequency/2,TANGUY.synth.currentTime),TANGUY.lp_filter1.frequency.linearRampToValueAtTime(e,TANGUY.synth.currentTime+TANGUY.program.filter.attack),TANGUY.lp_filter2.frequency.linearRampToValueAtTime(e/2,TANGUY.synth.currentTime+TANGUY.program.filter.attack),TANGUY.lp_filter1.frequency.setTargetAtTime(TANGUY.program.filter.frequency+TANGUY.program.filter.env_amt*TANGUY.program.filter.sustain,t,TANGUY.program.filter.decay),TANGUY.lp_filter2.frequency.setTargetAtTime((TANGUY.program.filter.frequency+TANGUY.program.filter.env_amt*TANGUY.program.filter.sustain)/2,t,TANGUY.program.filter.decay);break;case"bp":TANGUY.bp_filter1.frequency.setValueAtTime(TANGUY.program.filter.frequency,TANGUY.synth.currentTime),TANGUY.bp_filter2.frequency.setValueAtTime(.9*TANGUY.program.filter.frequency,TANGUY.synth.currentTime),TANGUY.bp_filter3.frequency.setValueAtTime(1.1*TANGUY.program.filter.frequency,TANGUY.synth.currentTime),TANGUY.bp_filter1.frequency.linearRampToValueAtTime(e,TANGUY.synth.currentTime+TANGUY.program.filter.attack),TANGUY.bp_filter2.frequency.linearRampToValueAtTime(.9*e,TANGUY.synth.currentTime+TANGUY.program.filter.attack),TANGUY.bp_filter3.frequency.linearRampToValueAtTime(1.1*e,TANGUY.synth.currentTime+TANGUY.program.filter.attack),TANGUY.bp_filter1.frequency.setTargetAtTime(TANGUY.program.filter.frequency+TANGUY.program.filter.env_amt*TANGUY.program.filter.sustain,t,TANGUY.program.filter.decay),TANGUY.bp_filter2.frequency.setTargetAtTime(.9*(TANGUY.program.filter.frequency+TANGUY.program.filter.env_amt*TANGUY.program.filter.sustain),t,TANGUY.program.filter.decay),TANGUY.bp_filter3.frequency.setTargetAtTime(1.1*(TANGUY.program.filter.frequency+TANGUY.program.filter.env_amt*TANGUY.program.filter.sustain),t,TANGUY.program.filter.decay);break;case"hp":TANGUY.hp_filter1.frequency.setValueAtTime(TANGUY.program.filter.frequency,TANGUY.synth.currentTime),TANGUY.hp_filter2.frequency.setValueAtTime(TANGUY.program.filter.frequency,TANGUY.synth.currentTime),TANGUY.hp_filter1.frequency.linearRampToValueAtTime(e,TANGUY.synth.currentTime+TANGUY.program.filter.attack),TANGUY.hp_filter2.frequency.linearRampToValueAtTime(e,TANGUY.synth.currentTime+TANGUY.program.filter.attack),TANGUY.hp_filter1.frequency.setTargetAtTime(TANGUY.program.filter.frequency+TANGUY.program.filter.env_amt*TANGUY.program.filter.sustain,t,TANGUY.program.filter.decay),TANGUY.hp_filter2.frequency.setTargetAtTime(TANGUY.program.filter.frequency+TANGUY.program.filter.env_amt*TANGUY.program.filter.sustain,t,TANGUY.program.filter.decay);break;case"notch":TANGUY.notch1.frequency.setValueAtTime(TANGUY.program.filter.frequency,TANGUY.synth.currentTime),TANGUY.notch2.frequency.setValueAtTime(.9*TANGUY.program.filter.frequency,TANGUY.synth.currentTime),TANGUY.notch3.frequency.setValueAtTime(1.1*TANGUY.program.filter.frequency,TANGUY.synth.currentTime),TANGUY.notch1.frequency.linearRampToValueAtTime(e,TANGUY.synth.currentTime+TANGUY.program.filter.attack),TANGUY.notch2.frequency.linearRampToValueAtTime(.9*e,TANGUY.synth.currentTime+TANGUY.program.filter.attack),TANGUY.notch3.frequency.linearRampToValueAtTime(1.1*e,TANGUY.synth.currentTime+TANGUY.program.filter.attack),TANGUY.notch1.frequency.setTargetAtTime(TANGUY.program.filter.frequency+TANGUY.program.filter.env_amt*TANGUY.program.filter.sustain,t,TANGUY.program.filter.decay),TANGUY.notch2.frequency.setTargetAtTime(.9*(TANGUY.program.filter.frequency+TANGUY.program.filter.env_amt*TANGUY.program.filter.sustain),t,TANGUY.program.filter.decay),TANGUY.notch3.frequency.setTargetAtTime(1.1*(TANGUY.program.filter.frequency+TANGUY.program.filter.env_amt*TANGUY.program.filter.sustain),t,TANGUY.program.filter.decay)}TANGUY.calculate_pitch(parseFloat(this.getAttribute("data-keyboard-position")),parseFloat(this.getAttribute("data-note-value"))),TANGUY.vca.gain.setValueAtTime(TANGUY.program.vca.gain,TANGUY.synth.currentTime),TANGUY.vca.gain.linearRampToValueAtTime(1,TANGUY.synth.currentTime+TANGUY.program.vca.attack),TANGUY.vca.gain.setTargetAtTime(TANGUY.program.vca.sustain+TANGUY.program.vca.gain,r,TANGUY.program.vca.decay)},TANGUY.gate_off=function(){"use strict";var e,t=TANGUY.vca.gain.value;switch(TANGUY.program.filter.mode){case"lp":e=TANGUY.lp_filter1.frequency.value,TANGUY.lp_filter1.frequency.cancelScheduledValues(TANGUY.synth.currentTime),TANGUY.lp_filter2.frequency.cancelScheduledValues(TANGUY.synth.currentTime),TANGUY.lp_filter1.frequency.setValueAtTime(e,TANGUY.synth.currentTime),TANGUY.lp_filter2.frequency.setValueAtTime(e/2,TANGUY.synth.currentTime),TANGUY.lp_filter1.frequency.setTargetAtTime(TANGUY.program.filter.frequency,TANGUY.synth.currentTime,TANGUY.program.filter.release),TANGUY.lp_filter2.frequency.setTargetAtTime(TANGUY.program.filter.frequency/2,TANGUY.synth.currentTime,TANGUY.program.filter.release);break;case"bp":e=TANGUY.bp_filter1.frequency.value,TANGUY.bp_filter1.frequency.cancelScheduledValues(TANGUY.synth.currentTime),TANGUY.bp_filter2.frequency.cancelScheduledValues(TANGUY.synth.currentTime),TANGUY.bp_filter3.frequency.cancelScheduledValues(TANGUY.synth.currentTime),TANGUY.bp_filter1.frequency.setValueAtTime(e,TANGUY.synth.currentTime),TANGUY.bp_filter2.frequency.setValueAtTime(.9*e,TANGUY.synth.currentTime),TANGUY.bp_filter3.frequency.setValueAtTime(1.1*e,TANGUY.synth.currentTime),TANGUY.bp_filter1.frequency.setTargetAtTime(TANGUY.program.filter.frequency,TANGUY.synth.currentTime,TANGUY.program.filter.release),TANGUY.bp_filter2.frequency.setTargetAtTime(.9*TANGUY.program.filter.frequency,TANGUY.synth.currentTime,TANGUY.program.filter.release),TANGUY.bp_filter3.frequency.setTargetAtTime(1.1*TANGUY.program.filter.frequency,TANGUY.synth.currentTime,TANGUY.program.filter.release);break;case"hp":e=TANGUY.hp_filter1.frequency.value,TANGUY.hp_filter1.frequency.cancelScheduledValues(TANGUY.synth.currentTime),TANGUY.hp_filter2.frequency.cancelScheduledValues(TANGUY.synth.currentTime),TANGUY.hp_filter1.frequency.setValueAtTime(e,TANGUY.synth.currentTime),TANGUY.hp_filter2.frequency.setValueAtTime(e,TANGUY.synth.currentTime),TANGUY.hp_filter1.frequency.setTargetAtTime(TANGUY.program.filter.frequency,TANGUY.synth.currentTime,TANGUY.program.filter.release),TANGUY.hp_filter2.frequency.setTargetAtTime(TANGUY.program.filter.frequency,TANGUY.synth.currentTime,TANGUY.program.filter.release);break;case"notch":e=TANGUY.notch1.frequency.value,TANGUY.notch1.frequency.cancelScheduledValues(TANGUY.synth.currentTime),TANGUY.notch2.frequency.cancelScheduledValues(TANGUY.synth.currentTime),TANGUY.notch3.frequency.cancelScheduledValues(TANGUY.synth.currentTime),TANGUY.notch1.frequency.setValueAtTime(e,TANGUY.synth.currentTime),TANGUY.notch2.frequency.setValueAtTime(.9*e,TANGUY.synth.currentTime),TANGUY.notch3.frequency.setValueAtTime(1.1*e,TANGUY.synth.currentTime),TANGUY.notch1.frequency.setTargetAtTime(TANGUY.program.filter.frequency,TANGUY.synth.currentTime,TANGUY.program.filter.release),TANGUY.notch2.frequency.setTargetAtTime(.9*TANGUY.program.filter.frequency,TANGUY.synth.currentTime,TANGUY.program.filter.release),TANGUY.notch3.frequency.setTargetAtTime(1.1*TANGUY.program.filter.frequency,TANGUY.synth.currentTime,TANGUY.program.filter.release)}TANGUY.vca.gain.cancelScheduledValues(TANGUY.synth.currentTime),TANGUY.vca.gain.setValueAtTime(t,TANGUY.synth.currentTime),TANGUY.vca.gain.setTargetAtTime(TANGUY.program.vca.gain,TANGUY.synth.currentTime,TANGUY.program.vca.release)},TANGUY.build_synth=function(){"use strict";var e,t,r,a,s,n,i,c,o,T,A;for(TANGUY.delay1_vca=TANGUY.synth.createGain(),TANGUY.delay2_vca=TANGUY.synth.createGain(),TANGUY.delay3_vca=TANGUY.synth.createGain(),TANGUY.delay4_vca=TANGUY.synth.createGain(),TANGUY.delay1_vca.gain.value=0,TANGUY.delay2_vca.gain.value=0,TANGUY.delay3_vca.gain.value=0,TANGUY.delay4_vca.gain.value=0,TANGUY.delay1_vca.connect(TANGUY.synth.destination),TANGUY.delay2_vca.connect(TANGUY.synth.destination),TANGUY.delay3_vca.connect(TANGUY.synth.destination),TANGUY.delay4_vca.connect(TANGUY.synth.destination),TANGUY.delay1=TANGUY.synth.createDelay(2),TANGUY.delay2=TANGUY.synth.createDelay(2),TANGUY.delay3=TANGUY.synth.createDelay(2),TANGUY.delay4=TANGUY.synth.createDelay(2),TANGUY.delay1.connect(TANGUY.delay1_vca),TANGUY.delay2.connect(TANGUY.delay2_vca),TANGUY.delay3.connect(TANGUY.delay3_vca),TANGUY.delay4.connect(TANGUY.delay4_vca),TANGUY.delay1_vca.connect(TANGUY.delay2),TANGUY.delay2_vca.connect(TANGUY.delay3),TANGUY.delay3_vca.connect(TANGUY.delay4),TANGUY.vca=TANGUY.synth.createGain(),TANGUY.vca.gain.value=0,TANGUY.vca.connect(TANGUY.delay1),TANGUY.vca.connect(TANGUY.synth.destination),TANGUY.lp_filter1=TANGUY.synth.createBiquadFilter(),TANGUY.lp_filter2=TANGUY.synth.createBiquadFilter(),TANGUY.lp_filter1.type="lowpass",TANGUY.lp_filter2.type="lowpass",TANGUY.lp_filter1.connect(TANGUY.lp_filter2),TANGUY.lp_filter2.connect(TANGUY.vca),TANGUY.bp_filter1=TANGUY.synth.createBiquadFilter(),TANGUY.bp_filter2=TANGUY.synth.createBiquadFilter(),TANGUY.bp_filter3=TANGUY.synth.createBiquadFilter(),TANGUY.bp_filter1.type="bandpass",TANGUY.bp_filter2.type="peaking",TANGUY.bp_filter3.type="peaking",TANGUY.bp_filter1.Q.value=2,TANGUY.bp_filter2.Q.value=3,TANGUY.bp_filter3.Q.value=3,TANGUY.bp_filter1.connect(TANGUY.bp_filter2),TANGUY.bp_filter2.connect(TANGUY.bp_filter3),TANGUY.bp_filter3.connect(TANGUY.vca),TANGUY.hp_filter1=TANGUY.synth.createBiquadFilter(),TANGUY.hp_filter2=TANGUY.synth.createBiquadFilter(),TANGUY.hp_filter1.type="highpass",TANGUY.hp_filter2.type="highpass",TANGUY.hp_filter1.connect(TANGUY.hp_filter2),TANGUY.hp_filter2.connect(TANGUY.vca),TANGUY.notch1=TANGUY.synth.createBiquadFilter(),TANGUY.notch2=TANGUY.synth.createBiquadFilter(),TANGUY.notch3=TANGUY.synth.createBiquadFilter(),TANGUY.notch1.type="notch",TANGUY.notch2.type="peaking",TANGUY.notch3.type="peaking",TANGUY.notch1.Q.value=2,TANGUY.notch2.Q.value=3,TANGUY.notch3.Q.value=3,TANGUY.notch1.connect(TANGUY.notch2),TANGUY.notch2.connect(TANGUY.notch3),TANGUY.notch3.connect(TANGUY.vca),TANGUY.mixer=TANGUY.synth.createGain(),TANGUY.osc1_vca=TANGUY.synth.createGain(),TANGUY.osc2_vca=TANGUY.synth.createGain(),TANGUY.noise_vca=TANGUY.synth.createGain(),TANGUY.mixer.gain.value=1,TANGUY.mixer.connect(TANGUY.lp_filter1),TANGUY.osc1_vca.connect(TANGUY.mixer),TANGUY.osc2_vca.connect(TANGUY.mixer),TANGUY.noise_vca.connect(TANGUY.mixer),TANGUY.osc1_saw_vca=TANGUY.synth.createGain(),TANGUY.osc1_sqr_vca=TANGUY.synth.createGain(),TANGUY.osc1_tri_vca=TANGUY.synth.createGain(),TANGUY.osc1_sin_vca=TANGUY.synth.createGain(),TANGUY.osc1_saw_vca.connect(TANGUY.osc1_vca),TANGUY.osc1_sqr_vca.connect(TANGUY.osc1_vca),TANGUY.osc1_tri_vca.connect(TANGUY.osc1_vca),TANGUY.osc1_sin_vca.connect(TANGUY.osc1_vca),TANGUY.osc1_saw=TANGUY.synth.createOscillator(),TANGUY.osc1_sqr=TANGUY.synth.createOscillator(),TANGUY.osc1_tri=TANGUY.synth.createOscillator(),TANGUY.osc1_sin=TANGUY.synth.createOscillator(),TANGUY.osc1_saw.type="sawtooth",TANGUY.osc1_sqr.type="square",TANGUY.osc1_tri.type="triangle",TANGUY.osc1_sin.type="sine",TANGUY.osc1_saw.start(0),TANGUY.osc1_sqr.start(0),TANGUY.osc1_tri.start(0),TANGUY.osc1_sin.start(0),TANGUY.osc1_saw.connect(TANGUY.osc1_saw_vca),TANGUY.osc1_sqr.connect(TANGUY.osc1_sqr_vca),TANGUY.osc1_tri.connect(TANGUY.osc1_tri_vca),TANGUY.osc1_sin.connect(TANGUY.osc1_sin_vca),TANGUY.osc1_fm_vca=TANGUY.synth.createGain(),TANGUY.osc1_fm_vca.connect(TANGUY.osc1_saw.frequency),TANGUY.osc1_fm_vca.connect(TANGUY.osc1_sqr.frequency),TANGUY.osc1_fm_vca.connect(TANGUY.osc1_tri.frequency),TANGUY.osc1_fm_vca.connect(TANGUY.osc1_sin.frequency),TANGUY.waveshaper=TANGUY.synth.createWaveShaper(),TANGUY.waveshaper.connect(TANGUY.osc2_vca),TANGUY.osc2=TANGUY.synth.createOscillator(),TANGUY.osc2.start(0),TANGUY.osc2.connect(TANGUY.osc1_fm_vca),TANGUY.osc2.connect(TANGUY.waveshaper),TANGUY.osc2_fm_vca=TANGUY.synth.createGain(),TANGUY.osc2_fm_vca.connect(TANGUY.osc2.frequency),TANGUY.osc1_sin_vca.connect(TANGUY.osc2_fm_vca),TANGUY.pink_noise_filter1=TANGUY.synth.createBiquadFilter(),TANGUY.pink_noise_filter2=TANGUY.synth.createBiquadFilter(),TANGUY.pink_noise_filter1.type="lowpass",TANGUY.pink_noise_filter2.type="lowpass",TANGUY.pink_noise_filter1.frequency.value=8e3,TANGUY.pink_noise_filter2.frequency.value=4e3,TANGUY.pink_noise_filter1.Q.value=1,TANGUY.pink_noise_filter2.Q.value=1,TANGUY.pink_noise_filter1.connect(TANGUY.pink_noise_filter2),TANGUY.pink_noise_filter2.connect(TANGUY.noise_vca),TANGUY.empty_white_noise_buffer=TANGUY.synth.createBuffer(1,1,TANGUY.synth.sampleRate),TANGUY.empty_pink_noise_buffer=TANGUY.synth.createBuffer(1,1,TANGUY.synth.sampleRate),TANGUY.empty_red_noise_buffer=TANGUY.synth.createBuffer(1,1,TANGUY.synth.sampleRate),TANGUY.empty_blue_noise_buffer=TANGUY.synth.createBuffer(1,1,TANGUY.synth.sampleRate),TANGUY.empty_purple_noise_buffer=TANGUY.synth.createBuffer(1,1,TANGUY.synth.sampleRate),TANGUY.white_noise_buffer=TANGUY.synth.createBuffer(1,88200,TANGUY.synth.sampleRate),TANGUY.pink_noise_buffer=TANGUY.synth.createBuffer(1,44100,TANGUY.synth.sampleRate),TANGUY.red_noise_buffer=TANGUY.synth.createBuffer(1,44100,TANGUY.synth.sampleRate),TANGUY.blue_noise_buffer=TANGUY.synth.createBuffer(1,44100,TANGUY.synth.sampleRate),TANGUY.purple_noise_buffer=TANGUY.synth.createBuffer(1,44100,TANGUY.synth.sampleRate),TANGUY.white_noise=TANGUY.synth.createBufferSource(),TANGUY.pink_noise=TANGUY.synth.createBufferSource(),TANGUY.red_noise=TANGUY.synth.createBufferSource(),TANGUY.blue_noise=TANGUY.synth.createBufferSource(),TANGUY.purple_noise=TANGUY.synth.createBufferSource(),TANGUY.white_noise.start(0),TANGUY.pink_noise.start(0),TANGUY.red_noise.start(0),TANGUY.blue_noise.start(0),TANGUY.purple_noise.start(0),TANGUY.white_noise.loop=!0,TANGUY.pink_noise.loop=!0,TANGUY.red_noise.loop=!0,TANGUY.blue_noise.loop=!0,TANGUY.purple_noise.loop=!0,TANGUY.white_noise.buffer=TANGUY.white_noise_buffer,TANGUY.pink_noise.buffer=TANGUY.empty_pink_noise_buffer,TANGUY.red_noise.buffer=TANGUY.empty_red_noise_buffer,TANGUY.blue_noise.buffer=TANGUY.empty_blue_noise_buffer,TANGUY.purple_noise.buffer=TANGUY.empty_purple_noise_buffer,TANGUY.white_noise.connect(TANGUY.noise_vca),TANGUY.pink_noise.connect(TANGUY.pink_noise_filter1),TANGUY.red_noise.connect(TANGUY.noise_vca),TANGUY.blue_noise.connect(TANGUY.noise_vca),TANGUY.purple_noise.connect(TANGUY.noise_vca),e=TANGUY.white_noise_buffer.getChannelData(0),T=0;88200>T;T+=1)e[T]=2*Math.random()-1;for(t=TANGUY.pink_noise_buffer.getChannelData(0),T=0;44100>T;T+=1)for(t[T]=Math.floor((1980*Math.random()+20)/1e3),n=t[T],T+=1,A=0;4>A;A+=1)t[T]=Math.abs(n),T+=1,t[T]=.5*Math.abs(n);for(r=TANGUY.red_noise_buffer.getChannelData(0),T=0;44100>T;T+=1)for(r[T]=-1*Math.random()+2,i=r[T],T+=1,A=0;237>A;A+=1)r[T]=.5*i,T+=1;for(a=TANGUY.blue_noise_buffer.getChannelData(0),T=0;44100>T;T+=1)for(a[T]=-1*Math.random()+1,c=a[T],T+=1,A=0;137>A;A+=1)a[T]=.5*c,T+=1;for(s=TANGUY.purple_noise_buffer.getChannelData(0),T=0;44100>T;T+=1)for(s[T]=-1*Math.random()+1,o=s[T],T+=1,A=0;172>A;A+=1)s[T]=.75*o,T+=1;TANGUY.lfo_pitch_vca=TANGUY.synth.createGain(),TANGUY.lfo_filter_vca=TANGUY.synth.createGain(),TANGUY.lfo_amp_vca=TANGUY.synth.createGain(),TANGUY.lfo_pitch_vca.connect(TANGUY.osc1_saw.frequency),TANGUY.lfo_pitch_vca.connect(TANGUY.osc1_sqr.frequency),TANGUY.lfo_pitch_vca.connect(TANGUY.osc1_tri.frequency),TANGUY.lfo_pitch_vca.connect(TANGUY.osc1_sin.frequency),TANGUY.lfo_pitch_vca.connect(TANGUY.osc2.frequency),TANGUY.lfo_filter_vca.connect(TANGUY.lp_filter1.frequency),TANGUY.lfo_amp_vca.connect(TANGUY.mixer.gain),TANGUY.lfo=TANGUY.synth.createOscillator(),TANGUY.lfo.start(0),TANGUY.lfo.connect(TANGUY.lfo_pitch_vca),TANGUY.lfo.connect(TANGUY.lfo_filter_vca),TANGUY.lfo.connect(TANGUY.lfo_amp_vca)
},$(document).ready(function(){"use strict";TANGUY.build_synth(),TANGUY.load_program("initialize")}),$("#osc1-kbd").change(function(){"use strict";TANGUY.program.osc1.kbd=this.checked?!0:!1}),$("#osc1-coarse").on("change","input",function(){"use strict";var e,t=[TANGUY.osc1_saw,TANGUY.osc1_sqr,TANGUY.osc1_tri,TANGUY.osc1_sin];for(TANGUY.program.osc1.coarse=this.value,e=0;4>e;e+=1)t[e].frequency.setValueAtTime(440*this.value,TANGUY.synth.currentTime)}),$("#osc2-kbd").change(function(){"use strict";TANGUY.program.osc2.kbd=this.checked?!0:!1}),$("#osc2-coarse").on("change","input",function(){"use strict";TANGUY.program.osc2.coarse=this.value,TANGUY.osc2.frequency.setValueAtTime(TANGUY.osc2_master_pitch*this.value,TANGUY.synth.currentTime)}),$("#osc2-detune").mousedown(function(){"use strict";$(this).mousemove(function(){TANGUY.program.osc2.detune=parseFloat(this.value),void 0===TANGUY.osc2_pitch&&(TANGUY.osc2_pitch=TANGUY.osc2_master_pitch),TANGUY.osc2.detune.setValueAtTime(TANGUY.osc2_pitch+TANGUY.program.osc2.detune,TANGUY.synth.currentTime)})}).mouseup(TANGUY.stop_tweaking),$("#osc2-fine").mousedown(function(){"use strict";$(this).mousemove(function(){TANGUY.program.osc2.fine=parseFloat(this.value),TANGUY.osc2.frequency.setValueAtTime(TANGUY.osc2_master_pitch*TANGUY.program.osc2.coarse+TANGUY.program.osc2.fine,TANGUY.synth.currentTime)})}).mouseup(TANGUY.stop_tweaking),$("#osc2-waveform").on("change","#osc2-saw, #osc2-sqr, #osc2-tri, #osc2-sin",function(){"use strict";TANGUY.program.osc2.waveform=this.value,TANGUY.osc2.type=this.value}),$("#osc2-waveshape").mousedown(function(){"use strict";$(this).mousemove(function(){var e=this.value;TANGUY.program.osc2.shape_amt=this.value,TANGUY.waveshaper.curve=e>0?new Float32Array([1.6*e,-2.5*e,-1.2*e,-2.4*e,-1.6*e,-3.2*e,6.4*e,-3.2*e]):null})}).mouseup(TANGUY.stop_tweaking),$("#osc2-fm").mousedown(function(){"use strict";$(this).mousemove(function(){TANGUY.program.osc2.fm_amt=this.value,TANGUY.osc2_fm_vca.gain.setValueAtTime(this.value*this.value*24e3,TANGUY.synth.currentTime)})}).mouseup(TANGUY.stop_tweaking),$("#noise-color").on("change","input",function(){"use strict";switch(TANGUY.program.noise.color=this.value,this.value){case"white":TANGUY.white_noise.buffer=TANGUY.white_noise_buffer,TANGUY.pink_noise.buffer=TANGUY.empty_pink_noise_buffer,TANGUY.red_noise.buffer=TANGUY.empty_red_noise_buffer,TANGUY.blue_noise.buffer=TANGUY.empty_blue_noise_buffer,TANGUY.purple_noise.buffer=TANGUY.empty_purple_noise_buffer;break;case"pink":TANGUY.pink_noise.buffer=TANGUY.pink_noise_buffer,TANGUY.white_noise.buffer=TANGUY.empty_white_noise_buffer,TANGUY.red_noise.buffer=TANGUY.empty_red_noise_buffer,TANGUY.blue_noise.buffer=TANGUY.empty_blue_noise_buffer,TANGUY.purple_noise.buffer=TANGUY.empty_purple_noise_buffer;break;case"red":TANGUY.red_noise.buffer=TANGUY.red_noise_buffer,TANGUY.white_noise.buffer=TANGUY.empty_white_noise_buffer,TANGUY.pink_noise.buffer=TANGUY.empty_pink_noise_buffer,TANGUY.blue_noise.buffer=TANGUY.empty_blue_noise_buffer,TANGUY.purple_noise.buffer=TANGUY.empty_purple_noise_buffer;break;case"blue":TANGUY.blue_noise.buffer=TANGUY.blue_noise_buffer,TANGUY.white_noise.buffer=TANGUY.empty_white_noise_buffer,TANGUY.pink_noise.buffer=TANGUY.empty_pink_noise_buffer,TANGUY.red_noise.buffer=TANGUY.empty_red_noise_buffer,TANGUY.purple_noise.buffer=TANGUY.empty_purple_noise_buffer;break;case"purple":TANGUY.purple_noise.buffer=TANGUY.purple_noise_buffer,TANGUY.white_noise.buffer=TANGUY.empty_white_noise_buffer,TANGUY.pink_noise.buffer=TANGUY.empty_pink_noise_buffer,TANGUY.red_noise.buffer=TANGUY.empty_red_noise_buffer,TANGUY.blue_noise.buffer=TANGUY.empty_blue_noise_buffer}}),$("#lfo-shape").on("change","input",function(){"use strict";switch(this.value){case"sawtooth":TANGUY.program.lfo.shape="sawtooth",TANGUY.program.mod.direction=-1;break;case"ramp":TANGUY.program.lfo.shape="sawtooth",TANGUY.program.mod.direction=1;break;case"sine":case"triangle":case"square":TANGUY.program.lfo.shape=this.value,TANGUY.program.mod.direction=1}TANGUY.lfo.type=TANGUY.program.lfo.shape,TANGUY.calculate_lfo()}),$("#lfo-rate").mousedown(function(){"use strict";$(this).mousemove(function(){TANGUY.program.lfo.rate=this.value*this.value*100,TANGUY.lfo.frequency.value=this.value*this.value*100})}).mouseup(TANGUY.stop_tweaking),$("#lfo-pitch").mousedown(function(){"use strict";$(this).mousemove(function(){TANGUY.program.lfo.pitch_amt=this.value,TANGUY.calculate_lfo("pitch")})}).mouseup(TANGUY.stop_tweaking),$("#lfo-filter").mousedown(function(){"use strict";$(this).mousemove(function(){TANGUY.program.lfo.filter_amt=this.value,TANGUY.calculate_lfo("filter")})}).mouseup(TANGUY.stop_tweaking),$("#lfo-amp").mousedown(function(){"use strict";$(this).mousemove(function(){TANGUY.program.lfo.amp_amt=this.value,TANGUY.calculate_lfo("amp")})}).mouseup(TANGUY.stop_tweaking),$("#delay-rate").mousedown(function(){"use strict";var e,t=[TANGUY.delay1,TANGUY.delay2,TANGUY.delay3,TANGUY.delay4];$(this).mousemove(function(){for(TANGUY.program.delay.rate=2*this.value,e=0;4>e;e+=1)t[e].delayTime.value=2*this.value})}).mouseup(TANGUY.stop_tweaking),$("#delay-amount").mousedown(function(){"use strict";var e,t=[TANGUY.delay1_vca,TANGUY.delay2_vca,TANGUY.delay3_vca,TANGUY.delay4_vca];$(this).mousemove(function(){for(TANGUY.program.delay.amt=this.value*this.value,e=0;4>e;e+=1)t[e].gain.value=this.value*this.value})}).mouseup(TANGUY.stop_tweaking),TANGUY.update_osc1_mix=function(){"use strict";return TANGUY.osc1_vca.gain.setValueAtTime(TANGUY.program.osc1_mix*TANGUY.program.osc1_mix,TANGUY.synth.currentTime)},TANGUY.update_osc2_mix=function(){"use strict";return TANGUY.osc2_vca.gain.setValueAtTime(TANGUY.program.osc2_mix*TANGUY.program.osc2_mix,TANGUY.synth.currentTime)},TANGUY.update_noise_mix=function(){"use strict";return TANGUY.noise_vca.gain.setValueAtTime(TANGUY.program.noise_mix*TANGUY.program.noise_mix,TANGUY.synth.currentTime)},$("#filter-mode").on("change","input",function(){"use strict";switch(TANGUY.mixer.disconnect(),TANGUY.lfo_filter_vca.disconnect(),TANGUY.program.filter.mode=this.value,this.value){case"lp":TANGUY.mixer.connect(TANGUY.lp_filter1),TANGUY.lfo_filter_vca.connect(TANGUY.lp_filter1.frequency),TANGUY.lfo_filter_vca.connect(TANGUY.lp_filter2.frequency);break;case"bp":TANGUY.mixer.connect(TANGUY.bp_filter1),TANGUY.lfo_filter_vca.connect(TANGUY.bp_filter1.frequency),TANGUY.lfo_filter_vca.connect(TANGUY.bp_filter2.frequency),TANGUY.lfo_filter_vca.connect(TANGUY.bp_filter3.frequency);break;case"hp":TANGUY.mixer.connect(TANGUY.hp_filter1),TANGUY.lfo_filter_vca.connect(TANGUY.hp_filter1.frequency),TANGUY.lfo_filter_vca.connect(TANGUY.hp_filter2.frequency);break;case"notch":TANGUY.mixer.connect(TANGUY.notch1),TANGUY.lfo_filter_vca.connect(TANGUY.notch1.frequency),TANGUY.lfo_filter_vca.connect(TANGUY.notch2.frequency),TANGUY.lfo_filter_vca.connect(TANGUY.notch3.frequency);break;case"off":TANGUY.mixer.connect(TANGUY.vca)}}),$("#filter-eg").on("change","input",$(this),function(e){"use strict";var t=e.currentTarget.getAttribute("data-param");TANGUY.program.filter[t]=parseFloat(e.currentTarget.value)}),$("#filter").on("change","#filter-envelope-amount, #filter-keyboard-tracking",$(this),function(e){"use strict";var t=e.currentTarget.getAttribute("data-param");TANGUY.program.filter[t]=parseFloat(e.currentTarget.value)}),$("#vca-gain").mousedown(function(){"use strict";$(this).mousemove(function(){TANGUY.program.vca.gain=this.value*this.value,TANGUY.vca.gain.setTargetAtTime(TANGUY.program.vca.gain,TANGUY.synth.currentTime,.01)})}).mouseup(TANGUY.stop_tweaking),$("#portamento").on("change","#portamento-amount, #portamento-off, #portamento-linear, #portamento-exponential",function(){"use strict";var e=this.getAttribute("data-portamento");"amount"===e?TANGUY.program.portamento.amt=parseFloat(this.value):TANGUY.program.portamento.mode=this.value}),$("#pitch-bend").mousedown(function(){"use strict";var e,t=[TANGUY.osc1_saw,TANGUY.osc1_sqr,TANGUY.osc1_tri,TANGUY.osc1_sin];$(this).mousemove(function(){for(e=0;4>e;e+=1)t[e].detune.setTargetAtTime(TANGUY.osc1_pitch+100*this.value,TANGUY.synth.currentTime,.2);TANGUY.osc2.detune.setTargetAtTime(TANGUY.osc2_pitch+100*this.value,TANGUY.synth.currentTime,.2)}).mouseup(function(){for($(this).val(0).unbind("mousemove"),e=0;4>e;e+=1)t[e].detune.setTargetAtTime(TANGUY.osc1_pitch+100*this.value,TANGUY.synth.currentTime,.2);TANGUY.osc2.detune.setTargetAtTime(TANGUY.osc2_pitch+100*this.value,TANGUY.synth.currentTime,.2)})}),$("#mod-amount").mousedown(function(){"use strict";$(this).mousemove(function(){TANGUY.program.mod.amt=this.value,TANGUY.calculate_lfo()})}).mouseup(TANGUY.stop_tweaking),TANGUY.slider={grab:function(){"use strict";var e={program:this.getAttribute("data-program"),update:this.getAttribute("data-update")};return $(this).mousemove(e,TANGUY.store_program).mouseup(TANGUY.slider.release)},release:function(){"use strict";return $(this).unbind("mousemove")}},$("#vca-eg").on("mousedown","input",TANGUY.slider.grab),$("#mixer").on("mousedown","input",TANGUY.slider.grab),$("#filter").on("mousedown","input",TANGUY.slider.grab),TANGUY.store_program=function(e){"use strict";return TANGUY.program[e.data.program]=parseFloat(e.currentTarget.value),TANGUY[e.data.update]?(console.log("Neat!"),TANGUY[e.data.update]()):void 0},TANGUY.update_vca_attack2=function(){"use strict";console.log("vca attack pointless")},TANGUY.update_cutoff=function(){"use strict";var e=TANGUY.program.cutoff*TANGUY.program.cutoff*22030+20;switch(TANGUY.program.filter.mode){case"lp":TANGUY.lp_filter1.frequency.setTargetAtTime(e,TANGUY.synth.currentTime,.08),TANGUY.lp_filter2.frequency.setTargetAtTime(e/2,TANGUY.synth.currentTime,.08);break;case"bp":TANGUY.bp_filter1.frequency.setTargetAtTime(e,TANGUY.synth.currentTime,.08),TANGUY.bp_filter2.frequency.setTargetAtTime(.9*e,TANGUY.synth.currentTime,.08),TANGUY.bp_filter3.frequency.setTargetAtTime(1.1*e,TANGUY.synth.currentTime,.08);break;case"hp":TANGUY.hp_filter1.frequency.setTargetAtTime(e,TANGUY.synth.currentTime,.08),TANGUY.hp_filter2.frequency.setTargetAtTime(e,TANGUY.synth.currentTime,.08);break;case"notch":TANGUY.notch1.frequency.setTargetAtTime(e,TANGUY.synth.currentTime,.08),TANGUY.notch2.frequency.setTargetAtTime(.9*e,TANGUY.synth.currentTime,.08),TANGUY.notch3.frequency.setTargetAtTime(1.1*e,TANGUY.synth.currentTime,.08)}},TANGUY.update_resonance=function(){"use strict";var e=TANGUY.program.res*TANGUY.program.res*1e3;switch(TANGUY.program.filter.mode){case"lp":TANGUY.lp_filter1.Q.setTargetAtTime(e/82,TANGUY.synth.currentTime,.01),TANGUY.lp_filter2.Q.setTargetAtTime(e/123,TANGUY.synth.currentTime,.01);break;case"bp":TANGUY.bp_filter2.gain.setTargetAtTime(e/82,TANGUY.synth.currentTime,.01),TANGUY.bp_filter3.gain.setTargetAtTime(e/82,TANGUY.synth.currentTime,.01);break;case"hp":TANGUY.hp_filter1.Q.setTargetAtTime(e/82,TANGUY.synth.currentTime,.01),TANGUY.hp_filter2.Q.setTargetAtTime(e/123,TANGUY.synth.currentTime,.01);break;case"notch":TANGUY.notch2.gain.setTargetAtTime(e/-21,TANGUY.synth.currentTime,.01),TANGUY.notch3.gain.setTargetAtTime(e/-21,TANGUY.synth.currentTime,.01)}},$("#keyboard").on("mousedown","button",TANGUY.gate_on).on("mouseup","button",TANGUY.gate_off),$(document).keypress(function(e){"use strict";switch(e.which){case 45:TANGUY.shift_octave(-1);break;case 43:case 61:TANGUY.shift_octave(1);break;case 42:TANGUY.save_program()}}).keydown(function(e){"use strict";if(TANGUY.key_down===!1)switch(TANGUY.key_active=e.which,TANGUY.key_down=!0,e.which){case 65:$("#c1").trigger("mousedown").addClass("playing");break;case 83:$("#d1").trigger("mousedown").addClass("playing");break;case 68:$("#e1").trigger("mousedown").addClass("playing");break;case 70:$("#f1").trigger("mousedown").addClass("playing");break;case 71:$("#g1").trigger("mousedown").addClass("playing");break;case 72:$("#a1").trigger("mousedown").addClass("playing");break;case 74:$("#b1").trigger("mousedown").addClass("playing");break;case 75:$("#c2").trigger("mousedown").addClass("playing");break;case 76:$("#d2").trigger("mousedown").addClass("playing");break;case 186:$("#e2").trigger("mousedown").addClass("playing");break;case 222:$("#f2").trigger("mousedown").addClass("playing");break;case 87:$("#cs1").trigger("mousedown").addClass("playing");break;case 69:$("#ds1").trigger("mousedown").addClass("playing");break;case 84:$("#fs1").trigger("mousedown").addClass("playing");break;case 89:$("#gs1").trigger("mousedown").addClass("playing");break;case 85:$("#as1").trigger("mousedown").addClass("playing");break;case 79:$("#cs2").trigger("mousedown").addClass("playing");break;case 80:$("#ds2").trigger("mousedown").addClass("playing");break;case 221:$("#fs2").trigger("mousedown").addClass("playing")}}).keyup(function(e){"use strict";if(e.which===TANGUY.key_active)switch(TANGUY.key_down=!1,e.which){case 65:$("#c1").trigger("mouseup").removeClass("playing");break;case 83:$("#d1").trigger("mouseup").removeClass("playing");break;case 68:$("#e1").trigger("mouseup").removeClass("playing");break;case 70:$("#f1").trigger("mouseup").removeClass("playing");break;case 71:$("#g1").trigger("mouseup").removeClass("playing");break;case 72:$("#a1").trigger("mouseup").removeClass("playing");break;case 74:$("#b1").trigger("mouseup").removeClass("playing");break;case 75:$("#c2").trigger("mouseup").removeClass("playing");break;case 76:$("#d2").trigger("mouseup").removeClass("playing");break;case 186:$("#e2").trigger("mouseup").removeClass("playing");break;case 222:$("#f2").trigger("mouseup").removeClass("playing");break;case 87:$("#cs1").trigger("mouseup").removeClass("playing");break;case 69:$("#ds1").trigger("mouseup").removeClass("playing");break;case 84:$("#fs1").trigger("mouseup").removeClass("playing");break;case 89:$("#gs1").trigger("mouseup").removeClass("playing");break;case 85:$("#as1").trigger("mouseup").removeClass("playing");break;case 79:$("#cs2").trigger("mouseup").removeClass("playing");break;case 80:$("#ds2").trigger("mouseup").removeClass("playing");break;case 221:$("#fs2").trigger("mouseup").removeClass("playing")}});